<template>
  <div class="container">
    <div class="main-rules">
      <div class="main-rules-left">
        <div class="container-rules">
          <div class="main-rules-left__title">ПРАВИЛА ОБМЕНА</div>
          <div class="main-rules-left__content">
            <div class="main-rules-left__content_title">
              1. Стороны соглашения.
            </div>
            <div class="main-rules-left__content_text">
              Договор заключается между интернет сервисом по обмену криптовалюты
              365change.biz, далее Исполнитель, — с одной стороны, и Заказчик, в
              лице того, кто воспользовался услугами Исполнителя, — с другой
              стороны.
            </div>
            <div class="main-rules-left__content_title">
              2. Список терминов.
            </div>
            <div class="main-rules-left__content_text">
              2.1. Обмен титульных знаков — автоматизированный продукт интернет
              обслуживания, который предоставляется Исполнителем на основании
              данных правил. <br />
              2.2. Заказчик — физическое лицо, соглашающееся с условиями
              Исполнителя и данного соглашения, к которому присоединяется.
              <br />
              2.3. Титульный знак — условная единица той или иной платежной
              системы, которая соответствует расчетам электронных систем и
              обозначает объем прав, соответствующих договору системы
              электронной оплаты и ее Заказчика. <br />
              2.4. Заявка — сведения, переданные Заказчиком для использования
              средств Исполнителя в электронном виде и свидетельствующие о том,
              что он принимает условия пользования сервисом, которые
              предлагаются Исполнителем в данной заявке.
            </div>
            <div class="main-rules-left__content_title">
              3. Условия соглашения.
            </div>
            <div class="main-rules-left__content_text">
              Данные правила считаются организованными за счет условий
              общественной оферты, которая образуется во время подачи Заказчиком
              заявки и является одной из главных составляющих настоящего
              договора. Общественной офертой именуются отображаемые исполнителем
              сведения об условиях подачи заявки. Главным составляющим
              общественной оферты являются действия, сделанные в завершении
              подачи заявки Заказчиком и говорящие о его точных намерениях
              совершить сделку на условиях предложенных Исполнителем перед
              завершением данной заявки. Время, дата, и параметры заявки
              создаются Исполнителем автоматически в момент окончания
              формирования данной заявки. Предложение должно приняться
              Заказчиком в течение 24 часов от окончания формирования заявки.
              Договор по обслуживанию вступает в силу с момента поступления
              титульных знаков в полном размере, указанном в заявке, от
              Заказчика на реквизиты Исполнителя. Операции с титульными знаками
              учитываются согласно правилам, регламенту и формату электронных
              систем по расчетам. Договор действителен в течение срока , который
              устанавливается с момента подачи заявки до расторжения по
              инициативе одной из сторон.
            </div>
            <div class="main-rules-left__content_title">
              4. Предмет соглашения.
            </div>
            <div class="main-rules-left__content_text">
              Путем использования технических методов Исполнитель обязуется
              выполнять обмен титульных знаков за комиссионное вознаграждение от
              Заказчика, после подачи данным лицом заявки и совершает это путем
              продажи титульных знаков лицам, желающим их приобрести по сумме,
              указанной не ниже, чем в заявке поданной Заказчиком. Денежные
              средства Исполнитель обязуется переводить на указанные Заказчиком
              реквизиты. В случае возникновения во время обмена прибыли, она
              остается на счету Исполнителя, как дополнительная выгода и премия
              за комиссионные услуги.
            </div>
            <div class="main-rules-left__content_title">5. В дополнение.</div>
            <div class="main-rules-left__content_text">
              5.1. Если на счет Исполнителя поступает сумма, отличающаяся от
              указанной в заявке, Исполнитель делает перерасчет, который
              соответствует фактическому поступлению титульных знаков. Если
              данная сумма превышает указанную в заявке более чем на 10%,
              Исполнитель расторгает договор в одностороннем порядке и все
              средства возвращаются на реквизиты Заказчика, с учетом вычтенной
              суммы на комиссионные расходы во время перевода. <br />
              5.2. В случае, когда титульные знаки не отправляются Исполнителем
              на указанные реквизиты Заказчика в течение 24 часов, Заказчик
              имеет полное право потребовать расторжение соглашения и
              аннулировать свою заявку, тем самым совершая возврат титульных
              знаков на свой счет в полном объеме. Заявка на расторжение
              соглашения и возврата титульных знаков выполняется Исполнителем в
              том случае, если денежные средства еще не были переведены на
              указанные реквизиты Заказчика. В случае аннулирования договора,
              возврат электронной валюты производится в течение 24 часов с
              момента получения требовании о расторжении договора. Если задержки
              при возврате возникли не по вине Исполнителя, он не несет за них
              ответственности. <br />
              5.3. Если титульные знаки не поступаеют от Заказчика на счет
              Исполнителя в течение указанного срока, с момента подачи заявки
              Заказчиком, соглашение между сторонами расторгается Исполнителем с
              одной стороны, так как договор не вступает в действие. Заказчик
              может об этом не уведомляться. Если титульные знаки поступает на
              реквизиты Исполнителя после указанного срока, то такие средства
              переводятся обратно на счет Заказчика, причем все комиссионные
              расходы, связанные с переводом, вычитаются из данных средств.
              <br />
              5.4. Если происходит задержка перевода средств на реквизиты,
              указанные Заказчиком, по вине расчетной системы, Исполнитель не
              несет ответственности за ущерб, возникающий в результате долгого
              поступления денежных средств. В этом случае Заказчик должен
              согласиться с тем, что все претензии будут предъявляться к
              расчетной системе, а Исполнитель оказывает свою помощь по мере
              своих возможностей в рамках закона. <br />
              5.5. В случае обнаружения подделки коммуникационных потоков или
              оказания воздействия, с целью ухудшить работу Исполнителя, а
              именно его программного кода, заявка приостанавливается, а
              переведенные средства подвергаются перерасчету в соответствии с
              действующим соглашением. Если Заказчик не согласен с перерасчетом,
              он имеет полное право расторгнуть договор и титульные знаки
              отправятся на реквизиты указанные Заказчиком. <br />
              5.6. В случае пользования услугами Исполнителя, Заказчик полностью
              соглашается с тем, что Исполнитель несет ограниченную
              ответственность соответствующую рамкам настоящих правил полученных
              титульных знаков и не дает дополнительных гарантий Заказчику, а
              также не несет перед ним дополнительной ответственности.
              Соответственно Заказчик не несет дополнительной ответственности
              перед Исполнителем. <br />
              5.7. Заказчик обязуется выполнять нормы соответствующие
              законодательству, а также не подделывать коммуникационные потоки и
              не создавать препятствий для нормальной работы программного кода
              Исполнителя. <br />
              5.8.Исполнитель не несет ответственности за ущерб и последствия
              при ошибочном переводе электронной валюты в том случае, если
              Заказчик указал при подаче заявки неверные реквизиты. <br />
              5.9. Уважаемые пользователи, администратор обменного пункта может
              потребовать верификацию пользователя и заблокировать средства с
              последующим возвратом в том случае если транзакция вызывает
              сомнение в ее происхождения: не допустимый источник отправки,
              криптовалюта полученная мошенническим путем. Средства могут быть
              возвращены только после верификации, заблокированы на
              неопределенный срок, а также изъяты по запросу правоохранительных
              органов. <br />
              Полная верификация — видео селфи с паспортом, вход в кошелек с
              отправкой на адрес обменного пункта, заявкой и проговаривание
              голосом номера заявки и реквизитов для получения денежных средств.
              <br />
              Частичная верификация — видео или скриншот экрана с отправкой
              криптовалюты на адрес обменного пункта. <br />
              Данное правило является исключительно для предотвращения
              мошенническим действиям, таким как сдвоенным заявкам, двойными
              транзакциями, оплачиванием и не отправлением криптовалюты на адрес
              обменного пункта. <br />
              Данное правило необходимо в первую очередь для защиты
              добросовестных пользователей и предотвращения мошеннических
              действий. <br />
              5.10. Отправляйте точное количество криптовалюты, что указали в
              заявке. В противном случае для решения вопроса потребуется
              верификация платежа, после верификации возможен возврат
              криптовалюты за вычетом комиссии за отправку либо обмен с вычетом
              комиссии 5% из суммы обмена.
            </div>
            <div class="main-rules-left__content_title">
              6. Гарантийный срок
            </div>
            <div class="main-rules-left__content_text">
              В течение 24 часов с момента исполнения обмена титульных знаков
              Исполнитель дает гарантию на оказываемые услуги при условии, если
              не оговорены иные сроки.
            </div>
            <div class="main-rules-left__content_title">
              7. Непредвиденные обстоятельства.
            </div>
            <div class="main-rules-left__content_text">
              7.1 В случае, когда в процессе обработки заявки Заказчика
              возникают непредвиденные обстоятельства, способствующие
              невыполнению Исполнителем условий договора, сроки выполнения
              заявки переносятся на соответствующий срок длительности
              форс-мажора. За просроченные обязательства Исполнитель
              ответственности не несет. <br /><br />
              7.2 Обменный пункт оставляет за собой права отмены сделки,
              пользователь не может опираясь на основание выход обменного пункта
              за регламент времени или при росте или падении в сторону выгодную
              пользователю отменить операцию по своему желанию.
            </div>
            <div class="main-rules-left__content_title">
              8. Форма соглашения.
            </div>
            <div class="main-rules-left__content_text">
              Данное соглашение обе стороны, в лице Исполнителя и Заказчика,
              принимают как равноценный по юридической силе договор,
              обозначенный в письменной форме.
            </div>
            <div class="main-rules-left__content_title">
              9. Претензии и споры.
            </div>
            <div class="main-rules-left__content_text">
              Претензии по настоящему соглашению принимаются Исполнителем в
              форме электронного письма, в котором Заказчик указывает суть
              претензии. Данное письмо отправляется на указанные на сайте
              реквизиты Исполнителя.
            </div>
            <div class="main-rules-left__content_title">
              10. Проведение обменных операций.
            </div>
            <div class="main-rules-left__content_text">
              10.1.Категорически запрещается пользоваться услугами Исполнителя
              для проведения незаконных переводов и мошеннических действий. При
              заключении настоящего договора, Заказчик обязуется выполнять эти
              требования и в случае мошенничества нести уголовную
              ответственность, установленную законодательством на данный момент.
              <br />
              10.2. В случае невозможности выполнения заявки автоматически, по
              не зависящим от Исполнителя обстоятельствам, таким как отсутствие
              связи, нехватка средств, или же ошибочные данные Заказчика,
              средства поступают на счет в течение последующих 24 часов или же
              возвращается на реквизиты Заказчика за вычетом комиссионных
              расходов. <br />
              10.3.По первому требованию Исполнитель вправе передавать
              информацию о переводе электронной валюты правоохранительным
              органам, администрации расчетных систем, а также жертвам
              неправомерных действий, пострадавшим в результате доказанного
              судебными органами мошенничества. <br />
              10.4. Заказчик обязуется представить все документы, удостоверяющие
              его личность, в случае подозрения о мошенничестве и отмывании
              денег. <br />
              10.5. Заказчик обязуется не вмешиваться в работу Исполнителя и не
              наносить урон его программной и аппаратной части, а также Заказчик
              обязуется передавать точные сведения для обеспечения выполнения
              Исполнителем всех условий договора.
            </div>
            <div class="main-rules-left__content_title">
              11. Персональные данные.
            </div>
            <div class="main-rules-left__content_text">
              Заказчик, используя интернет сервис Исполнителя, соглашается с
              обработкой и хранением своих персональных данных Исполнителем, в
              соответствии с требованиями Федерального закона от 27.07.2006 г. №
              152-ФЗ "О персональных данных" (с изменениями и дополнениями).
            </div>
            <div class="main-rules-left__content_title">
              12. Отказ от обязательств.
            </div>
            <div class="main-rules-left__content_text">
              Исполнитель имеет право отказа на заключение договора и выполнение
              заявки, причем без объяснения причин. Данный пункт применяется по
              отношению к любому клиенту.
            </div>
          </div>
        </div>
      </div>
      <div v-show="!personIsAuth" class="main-rules-right">
        <div class="main-rules-right__title">Авторизация</div>
        <form
          class="main-rules-right__form"
          @submit.prevent="authorizationSubmitForm"
        >
          <div class="main-rules-right__form_login">
            <input
              type="text"
              class="main-rules-right__form_login_input"
              @blur="$v.formAuthorization.email.$touch()"
              v-model.trim="formAuthorization.email"
              placeholder="Email"
            />
            <div
              class="invalid-feed"
              v-if="
                $v.formAuthorization.email.$error ||
                ($v.formAuthorization.email.$dirty &&
                  !$v.formAuthorization.email.required)
              "
            >
              Необходимо указать email
            </div>
            <div class="invalid-feed" v-if="!$v.formAuthorization.email.email">
              Пожалуйста введите Email адрес
            </div>
          </div>
          <div class="main-rules-right__form_password">
            <input
              type="password"
              class="main-rules-right__form_password_input"
              @blur="$v.formAuthorization.password.$touch()"
              v-model.trim="formAuthorization.password"
              placeholder="Пароль"
            />
            <div
              class="invalid-feed"
              v-if="!$v.formAuthorization.password.minLength"
            >
              {{ minLengthText }}
            </div>
            <div
              class="invalid-feed"
              v-if="
                $v.formAuthorization.password.$error ||
                ($v.formAuthorization.password.$dirty &&
                  !$v.formAuthorization.password.required)
              "
            >
              Необходимо указать пароль
            </div>
          </div>
          <div class="main-rules-right__form_options">
            <router-link to="/recovery">Забыли пароль?</router-link>
            <router-link to="/register">Регистрация</router-link>
          </div>
          <div class="main-rules-right__form_btn">
            <button
              type="submit"
              :disabled="isDisabledBtnSubmit"
              @click.prevent="authorizationSubmitForm"
            >
              Войти
            </button>
          </div>
        </form>
      </div>
    </div>
    <div v-if="isLoading">
      <LoadingComponent />
    </div>
  </div>
</template>

<script>
import { minLength, required, email } from "vuelidate/lib/validators";

import LoadingComponent from "@/components/LoadingComponent.vue";

export default {
  name: "rule-view",
  created() {
    if (localStorage.getItem("token")) {
      this.personIsAuth = true;
    } else {
      this.personIsAuth = false;
    }
  },
  data() {
    return {
      personIsAuth: false,
      formAuthorization: {
        email: "",
        password: "",
      },
      isDisabledBtnSubmit: false,
      minLengthText: "Минимальная длина 8 символов!",
      isLoading: false,
    };
  },
  methods: {
    status(validation) {
      return {
        "is-invalid": validation.$error,
      };
    },
    async authorizationSubmitForm() {
      this.$v.$touch();
      if (this.$v.$invalid) {
        console.log("Error");
      } else {
        console.log("Success");
        try {
          this.isLoading = true;
          this.isDisabledBtnSubmit = true;
          const formData = {
            email: this.formAuthorization.email,
            password: this.formAuthorization.password,
          };
          const resultAuthorization = await this.$store.dispatch(
            "authorization",
            formData
          );

          if (
            resultAuthorization.message === "Пользователь успешно авторизовался"
          ) {
            this.isLoading = false;
            this.$alert(`${resultAuthorization.message}`, "Авторизация", {
              confirmButtonText: "На домашнюю страницу",
              callback: () => {
                this.isDisabledBtnSubmit = false;
                this.$router.push("/");
                this.$router.go(0);
              },
            });
          } else if (
            resultAuthorization.message === "Неправильный логин или пароль"
          ) {
            this.isLoading = false;
            this.$alert(`${resultAuthorization.message}`, "Авторизация", {
              confirmButtonText: "Попробовать ещё раз",
              callback: () => {
                this.isDisabledBtnSubmit = false;
                return;
              },
            });
          } else if (
            resultAuthorization.message ===
            "Пользователь с такой почтой не найден"
          ) {
            this.isLoading = false;
            this.$alert(`${resultAuthorization.message}`, "Авторизация", {
              confirmButtonText: "Попробовать ещё раз",
              callback: () => {
                this.isDisabledBtnSubmit = false;
                return;
              },
            });
          }
        } catch (error) {
          this.isLoading = false;
          this.isDisabledBtnSubmit = false;
          console.log(
            "Error in authorizationSubmitForm in LoginView func -->",
            error
          );
        }
      }
    },
  },
  components: {
    LoadingComponent,
  },
  validations: {
    formAuthorization: {
      email: {
        email,
        required,
      },
      password: {
        required,
        minLength: minLength(8),
      },
    },
  },
};
</script>

<style lang="scss" scoped>
.container {
  max-width: 960px;
  margin: 0 auto;
}

//
.main-rules {
  display: flex;
  justify-content: space-between;
  margin: 0 0 30px;
  padding: 40px 30px 25px 30px;
}

.container-rules {
  max-width: 610px;
}

.main-rules-left__title {
  margin: 0 0 25px;
  font: 300 23px/26px "Segoe UI";
  color: #929292;
  text-transform: uppercase;
}

.main-rules-left__content_title {
  font: 12px/1.5em "Segoe UI", sans-serif;
  color: #545454;
  padding: 0 0 20px 0;
  font-weight: 600;
}

.main-rules-left__content_text {
  font: 12px/1.5em "Segoe UI", sans-serif;
  color: #545454;
  padding: 0 0 20px 0;
}

// Right
.main-rules-right__title {
  margin: 0 -30px 0;
  padding: 20px 30px 25px;
  font: 600 18px/20px "Segoe UI";
  color: #929292;
}

.main-rules-right__form_login {
  padding: 0 0 20px 0;
}

.main-rules-right__form_login_input {
  outline: none;
  border: 1px solid #e2e2e2;
  background: #fff;
  opacity: 0.75;
  height: 40px;
  width: 200px;
  padding: 0 10px;
  transition: all 0.3s linear;
  box-sizing: border-box;
  color: #545454;
  font: 13px/40px "Segoe UI", sans-serif;
}

.main-rules-right__form_login_input:focus {
  border: 1px solid #00cccb;
}

.main-rules-right__form_password {
  padding: 0 0 20px 0;
}

.main-rules-right__form_password_input {
  outline: none;
  border: 1px solid #e2e2e2;
  background: #fff;
  opacity: 0.75;
  height: 40px;
  width: 200px;
  padding: 0 10px;
  transition: all 0.3s linear;
  box-sizing: border-box;
  color: #545454;
  font: 13px/40px "Segoe UI", sans-serif;
}

.main-rules-right__form_password_input:focus {
  border: 1px solid #00cccb;
}

.main-rules-right__form_options {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.main-rules-right__form_options > a {
  font: 12px/1.5em "Segoe UI", sans-serif;
  color: #000;
  text-decoration: none;
}

.main-rules-right__form_options > a:hover {
  color: #ffc512;
  text-decoration: underline;
}

.main-rules-right__form_btn {
  display: flex;
  justify-content: center;
  padding: 15px 20px;
  margin: 20px -30px 0;
}

.main-rules-right__form_btn > button {
  cursor: pointer;
  transition: all 0.3s linear;
  box-sizing: border-box;
  border: none;
  background: #e4e4e4;
  height: 40px;
  font: 100 14px/40px "Segoe UI", serif;
  text-transform: uppercase;
  color: #000;
  padding: 0 30px;
  text-decoration: none;
}

.main-rules-right__form_btn > button:hover {
  background: #ffc512;
}

.is-invalid {
  font-size: 12px;
  border: 1px solid #dc3545;
}

.invalid-feed {
  margin-top: 3px;
  font-size: 12px;
  color: #dc3545;
}

@media (max-width: 926px) {
  .container {
    max-width: 838px;
  }

  .main-rules {
    flex-wrap: wrap;
    justify-content: center;
  }

  .main-rules-right {
    margin-top: 40px;
  }
}

@media (max-width: 844px) {
  .container {
    max-width: 763px;
  }
}

@media (max-width: 834px) {
  .container {
    max-width: 754.77px;
  }
}

@media (max-width: 780px) {
  .container {
    max-width: 705.89px;
  }
}

@media (max-width: 768px) {
  .container {
    max-width: 695px;
  }
}

@media (max-width: 667px) {
  .container {
    max-width: 603px;
  }
}

@media (max-width: 568px) {
  .container {
    max-width: 514px;
  }
}

@media (max-width: 480px) {
  .container {
    max-width: 452.5px;
  }
}

@media (max-width: 428px) {
  .container {
    max-width: 390px;
  }

  .main-rules-left__title {
    font: 300 20px/26px "Segoe UI";
  }

  .main-rules-left__content_title {
    font: 11px/1.5em "Segoe UI", sans-serif;
    font-weight: 600;
  }

  .main-rules-left__content_text {
    font: 10px/1.5em "Segoe UI", sans-serif;
  }

  .main-rules-right__form_login_input {
    font: 11px/40px "Segoe UI", sans-serif;
  }

  .main-rules-right__form_password_input {
    font: 11px/40px "Segoe UI", sans-serif;
  }

  .main-rules-right__form_options > a {
    font: 11px/1.5em "Segoe UI", sans-serif;
  }
}

@media (max-width: 414px) {
  .container {
    max-width: 380px;
  }
}

@media (max-width: 390px) {
  .container {
    max-width: 355px;
  }
}

@media (max-width: 375px) {
  .container-login {
    max-width: 355px;
  }
}

@media (max-width: 360px) {
  .container {
    max-width: 333px;
  }

  .main-rules-left__content_title {
    font: 10px/1.5em "Segoe UI", sans-serif;
    font-weight: 600;
  }

  .main-rules-left__content_text {
    font: 9px/1.5em "Segoe UI", sans-serif;
  }
}

@media (max-width: 320px) {
  .container {
    max-width: 300px;
  }
}
</style>